# Выполнение проверки

После заполнения объекта `Validation` остается только запустить саму проверку. Для этого вызывайте метод [Validation::check].
 Он возвращает булевское значение **TRUE/FALSE** в зависимости от успешности проверки.

Весьма полезно знать, что происходит внутри метода `check()`, из каких этапов состоит проверка данных.

## Инициализация {#init}

 * Формируется список проверяемых полей массива. Он состоит их переданных в массиве ключей, проверяемых [правилами](validation/rules) полей,
  а также явно указанных [меток](validation/labels).
 * Формируется список значений массива. Список полей может отличаться от оригинального, если значений нет в массиве, но ключи
  явно указаны в метках или правилах. Для таких полей устанавливаются значения `NULL`.
 * Собираются правила для каждого проверяемого поля. Это явно указанные правила + правила для всех полей (`->rule(TRUE, ...)`).
 * Создаются глобальные контексты (неизменны во время работы проверки).
   * `:data` - проверяемый массив данных (именно массив, а не объект).
   * `:validation` - объект `Validation`, т.е. `$this`.

## Запуск правил {#execution}

Описанный ниже алгоритм выполняется последовательно для каждого проверяемого поля.

 * Создаются локальные контексты (у каждого поля/правила свои):
   * `:field` - имя проверяемого поля.
   * `:value` - значение этого поля.
 * В цикле выполняются все имеющиеся у поля правила.
   * Сперва передаваемые в правило аргументы анализируются на наличие контекстов. Т.е. строки вида ':value' заменяются на
      соответствующие значения.
   * Затем запускается само правило. Если правило вернуло FALSE, то сохраняется ошибка для данного поля, цикл для поля
     прекращается. Таким образом, нельзя собрать все ошибки для поля, а только первое по списку.

Результат проверки определяется по наличию [ошибок](validation/errors). Если есть хотя бы одна - возвращается **FALSE**.

# Примечание {#notes}

Валидация в Kohana 3.2 не предусматривает фильтрацию данных, и вообще каких-либо изменений исходных данных во время проверки.
 Даже если вы добавите свой *callback*, в котором сможете внести изменения в проверяемый массив, `Validation` все равно вернет
 его в исходное состояние.

Если поле пустое (т.е. **NULL**, **FALSE**, пустая строка или пустой массив), то оно в большинстве случае не будет обработано.
 Это логично, если поле необязательное. Существует три исключения - это правила [Valid::not_empty] и [Valid::matches],
 а также анонимные функции. Первое отвечает как раз за проверку на наличие значения (оно используется, чтобы явно указать
 обязательную передачу поля), а второе сравнивает несколько полей. Анонимные функции самостоятельно регистрируют ошибки,
 поэтому в случае необходимости добавляйте в них проверку вручную.

[!!] Если быть точным, пустое поле будет обработано, и все правила на нем сработают. Но вот возможная ошибка не будет сохранена.