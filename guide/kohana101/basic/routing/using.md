# Работа с маршрутами

## Кэширование {#caching}

Если в проекте большое количество маршрутов (и они все объявляются в одном месте), имеет смысл подумать о кешировании.

Примерная схема такова:

    // где-то в bootstrap'е
    if ( ! Route::cache() )
    {
        // в кэше не найдены сохраненные маршруты
        Route::set(...);
        Route::set(...);
        // в самом конце сохраняем маршруты в кэш
        Route::cache(TRUE);
    }

Маршруты сохраняются в файловый кэш, механизм тот же самый, что у кэширования внутренних путей [КФС](intro/cascadefs).

Для проверки, использовалось ли кэширование маршрутов, проверяем свойство `Route::$cache`. Оно равно **TRUE** в том случае,
 если маршруты были загружены иэ кэша.

## Полезные методы {#using}

Иногда необходимо не только добавить маршрут. На стадии написания кода и его отладки бывает необходимо более плотно
 поработать с объектами `Route`.

 * Получение маршрута по его имени

~~~
    $route = Route::get('default');
~~~

Возвращает маршрут по его имени. Если маршрут не был добавлен, то сгенерируется исключение `Kohana_Exception`.

[!!] Кроме того, маршрут возвращается как результат выполнения метода `Route::set()`. Т.е. `$route = Route::set('default', ...)`
 является более короткой (и быстрой) версией комбинации `Route::set()` и `Route::get()`.

 * Получение имени маршрута из объекта `Route`

~~~
    $name = Route::name($route);
~~~

 * Проверка маршрута

На стадии тестирования часто возникает вопрос, а почему некий URI не обрабатывается конкретным маршрутом. Чтобы определить,
 подходит ли этот адрес под условия маршрута, используйте метод `matches()`:

~~~
    // адрес 'foo/bar/baz' будет обрабатываться маршрутом
    if ($params = $route->matches('foo/bar/baz')) {
~~~

[!!] Не забудьте убрать слэши в начале и конце адреса, иначе проверка вернет **FALSE**. Т.е. в общем виде надо использовать
 что-то вроде `if ($params = $route->matches(trim($uri, '/')))`.

Если проверка успешна, то в переменной $params будут сохранены сегменты, полученные из переданного URI (controller, action и т.д.).
 В противном случае получим **FALSE**.